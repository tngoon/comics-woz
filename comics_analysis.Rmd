---
title: "Comics WOZ analysis"
output: html_notebook
---
```{r}
#libraries
library(ggplot2)
library(car)
library(dplyr)
library(reshape2)
library(pwr)
library(irr)
library(coin)
```

```{r}
comics_data <- read.table("data.csv",header=TRUE,sep=",")
head(comics_data)
```
Each row is split into condition according to which comic was shown as "Comic A" in each pair. For OrderReversed=TRUE, the adaptive (wizard) comic was shown first; the opposite is true for for OrderReversed=FALSE. Each measure is assigned a 1 or 0 depending if comic A was chosen as the preferred comic for the measure.
```{r}
comics_data <- group_by(comics_data,condition)
aggregate <- summarise(comics_data,
                       n = length(condition),
                       v_clarity=length(which(vclarity==1))/length(condition),
                       v_creativity = length(which(vcreativity==1))/length(condition),
                       n_clarity = length(which(nclarity==1))/length(condition),
                       n_creativity = length(which(ncreativity==1))/length(condition),
                       all = length(which(overall==1))/length(condition))

aggregate
```
```{r}
vclarity <- table(comics_data$condition,comics_data$vclarity)
chisq.test(vclarity,correct=FALSE)

vcreativity <- table(comics_data$condition,comics_data$vcreativity)
chisq.test(vcreativity,correct=FALSE)

nclarity <- table(comics_data$condition,comics_data$nclarity)
chisq.test(nclarity,correct=FALSE)

ncreativity <- table(comics_data$condition,comics_data$ncreativity)
chisq.test(ncreativity,correct=FALSE)

overall <- table(comics_data$condition,comics_data$overall)
chisq.test(overall,correct=FALSE)
```

```{r}
data2 <- read.table("data2.csv",header=TRUE,sep=",")
counts <- summarise(data2,
                c_vclarity = (length(which(vclarity==0))/length(condition))*100,
                w_vclarity = (length(which(vclarity==1))/length(condition))*100,
                c_vcreativity = (length(which(vcreativity==0))/length(condition))*100,
                w_vcreativity = (length(which(vcreativity==1))/length(condition))*100,
                c_nclarity = (length(which(vclarity==0))/length(condition))*100,
                w_nclarity = (length(which(nclarity==1))/length(condition))*100,
                c_ncreativity = (length(which(ncreativity==0))/length(condition))*100,
                w_ncreativity = (length(which(ncreativity==1))/length(condition))*100,
                c_overall = (length(which(overall==0))/length(condition))*100,
                w_overall = (length(which(overall==1))/length(condition))*100)

counts
```


```{r}
dm <- melt(aggregate[,c('condition','v_clarity','v_creativity','n_clarity','n_creativity','all')], id.vars=1)
dm

ggplot(dm, aes(variable,value)) +
  geom_bar(aes(fill=condition), stat="identity") +
  theme_bw() +
  theme(text = element_text(size=18)) +
  theme(legend.title = element_blank()) +
  scale_fill_grey() +
  coord_flip()
```


